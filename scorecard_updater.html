<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cricket Scorecard Updater</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #141E30;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            padding: 20px;
        }
        .updater, .name-input {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        button, input {
            padding: 10px;
            margin: 5px;
            background-color: #00bfff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover, input:hover {
            background-color: #007bbf;
        }
        input {
            width: 150px;
            color: black;
        }
        .scorecard {
            background: #243B55;
            padding: 15px;
            border-radius: 10px;
            margin: 10px;
            text-align: center;
            width: 300px;
        }
    </style>
</head>
<body>
    <h1>Cricket Scorecard Updater</h1>

    <!-- Name Updater -->
    <div class="name-input">
        <input type="text" id="team1Name" placeholder="Team 1 Name">
        <input type="text" id="team2Name" placeholder="Team 2 Name">
        <input type="text" id="batter1Name" placeholder="Batter 1 Name">
        <input type="text" id="batter2Name" placeholder="Batter 2 Name">
        <input type="text" id="bowlerName" placeholder="Bowler Name">
        <button onclick="updateNames()">Update Names</button>
    </div>

    <!-- Scorecard Display -->
    <div class="scorecard">
        <p id="score">Score: 0-0</p>
        <p id="overs">Overs: 0.0</p>
        <p id="striker">Striker: Batter 1 (0 runs, 0 balls)</p>
        <p id="nonStriker">Non-Striker: Batter 2 (0 runs, 0 balls)</p>
        <p id="bowler">Bowler: Bowler 1 0/0 (0)</p>
    </div>

    <!-- Interactive Scoring -->
    <div class="updater">
        <button onclick="updateScore(1)">1 Run</button>
        <button onclick="updateScore(2)">2 Runs</button>
        <button onclick="updateScore(3)">3 Runs</button>
        <button onclick="updateScore(4)">4 Runs</button>
        <button onclick="updateScore(6)">6 Runs</button>
        <button onclick="noBall()">No Ball</button>
        <button onclick="wideBall()">Wide Ball</button>
        <button onclick="wicket()">Wicket</button>
    </div>

    <script>
        let runs = 0, wickets = 0, balls = 0, overs = 0.0;
        let batter1Score = 0, batter2Score = 0, batter1Balls = 0, batter2Balls = 0;
        let bowlerBalls = 0, bowlerRuns = 0, bowlerWickets = 0;
        let striker = 'Batter 1', nonStriker = 'Batter 2', bowler = 'Bowler 1';
        let team1 = 'Team 1', team2 = 'Team 2';

        function updateNames() {
            team1 = document.getElementById("team1Name").value || 'Team 1';
            team2 = document.getElementById("team2Name").value || 'Team 2';
            striker = document.getElementById("batter1Name").value || 'Batter 1';
            nonStriker = document.getElementById("batter2Name").value || 'Batter 2';
            bowler = document.getElementById("bowlerName").value || 'Bowler 1';
            updateDisplay();
        }

        function updateScore(run) {
            runs += run;
            balls++;
            bowlerRuns += run;
            bowlerBalls++;

            // Update striker's score
            if (striker === 'Batter 1') {
                batter1Score += run;
                batter1Balls++;
            } else {
                batter2Score += run;
                batter2Balls++;
            }

            if (balls % 6 === 0) {
                overs++;
                balls = 0;
            }

            // Swap striker if the run count is odd
            if (run % 2 !== 0) {
                [striker, nonStriker] = [nonStriker, striker];
                [batter1Score, batter2Score] = [batter2Score, batter1Score];
                [batter1Balls, batter2Balls] = [batter2Balls, batter1Balls];
            }

            updateBackend();
        }

        function noBall() {
            runs++;
            bowlerRuns++;
            updateBackend();
        }

        function wideBall() {
            runs++;
            bowlerRuns++;
            updateBackend();
        }

        function wicket() {
            wickets++;
            bowlerWickets++;
            balls++;
            bowlerBalls++;
            updateBackend();
        }

        function updateBackend() {
            const data = {
                team1, team2, runs, wickets,
                overs: `${overs}.${balls}`,
                batter1: striker, batter2: nonStriker,
                batter1Score: `${batter1Score} (${batter1Balls})`,
                batter2Score: `${batter2Score} (${batter2Balls})`,
                bowler, bowlerBalls, bowlerRuns, bowlerWickets,
                striker: striker === 'Batter 1' ? 'batter1' : 'batter2'
            };

            fetch('/api/score', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(() => updateDisplay())
            .catch(err => alert("Failed to update score"));
        }

        function updateDisplay() {
            document.getElementById('score').textContent = `Score: ${runs}-${wickets}`;
            document.getElementById('overs').textContent = `Overs: ${overs}.${balls}`;
            document.getElementById('striker').textContent = `Striker: ${striker} (${batter1Score} runs, ${batter1Balls} balls)`;
            document.getElementById('nonStriker').textContent = `Non-Striker: ${nonStriker} (${batter2Score} runs, ${batter2Balls} balls)`;
            document.getElementById('bowler').textContent = `Bowler: ${bowler} ${bowlerRuns}/${bowlerWickets} (${bowlerBalls})`;
        }

        updateDisplay();
    </script>
</body>
</html>
