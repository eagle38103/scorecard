<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cricket Scorecard Updater</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #141E30;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            padding: 20px;
        }
        .updater, .name-input, .manual-input {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        button, input {
            padding: 10px;
            margin: 5px;
            background-color: #00bfff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover, input:hover {
            background-color: #007bbf;
        }
        input {
            width: 150px;
            color: black;
        }
        .scorecard {
            background: #243B55;
            padding: 15px;
            border-radius: 10px;
            margin: 10px;
            text-align: center;
            width: 300px;
        }
    </style>
</head>
<body>
    <h1>Cricket Scorecard Updater</h1>

    <!-- Name Updater -->
    <div class="name-input">
        <input type="text" id="team1Name" placeholder="Team 1 Name">
        <input type="text" id="team2Name" placeholder="Team 2 Name">
        <input type="text" id="batter1Name" placeholder="Batter 1 Name">
        <input type="text" id="batter2Name" placeholder="Batter 2 Name">
        <input type="text" id="bowlerName" placeholder="Bowler Name">
        <button onclick="updateNames()">Update Names</button>
    </div>

    <!-- Manual Input for Persistent Score -->
    <div class="manual-input">
        <input type="number" id="manualRuns" placeholder="Total Runs">
        <input type="number" id="manualWickets" placeholder="Total Wickets">
        <input type="number" id="manualOvers" placeholder="Overs (0.0)">
        <button onclick="manualUpdate()">Manual Update</button>
        <button onclick="clearScorecard()">Clear Scorecard</button>
    </div>

    <!-- Scorecard Display -->
    <div class="scorecard">
        <p id="score">Score: 0-0</p>
        <p id="overs">Overs: 0.0</p>
        <p id="striker">Striker: Batter 1 (0 runs, 0 balls)</p>
        <p id="nonStriker">Non-Striker: Batter 2 (0 runs, 0 balls)</p>
        <p id="bowler">Bowler: Bowler 1 0/0 (0)</p>
    </div>

    <!-- Interactive Scoring -->
    <div class="updater">
        <button onclick="updateScore(1)">1 Run</button>
        <button onclick="updateScore(2)">2 Runs</button>
        <button onclick="updateScore(3)">3 Runs</button>
        <button onclick="updateScore(4)">4 Runs</button>
        <button onclick="updateScore(6)">6 Runs</button>
        <button onclick="noBall()">No Ball</button>
        <button onclick="wideBall()">Wide Ball</button>
        <button onclick="wicket()">Wicket</button>
    </div>

    <script>
        let scoreData = JSON.parse(localStorage.getItem('scoreData')) || {
            runs: 0, wickets: 0, balls: 0, overs: 0.0,
            batter1Score: 0, batter2Score: 0, batter1Balls: 0, batter2Balls: 0,
            bowlerBalls: 0, bowlerRuns: 0, bowlerWickets: 0,
            striker: 'Batter 1', nonStriker: 'Batter 2', bowler: 'Bowler 1'
        };

        function updateNames() {
            scoreData.striker = document.getElementById("batter1Name").value || 'Batter 1';
            scoreData.nonStriker = document.getElementById("batter2Name").value || 'Batter 2';
            scoreData.bowler = document.getElementById("bowlerName").value || 'Bowler 1';
            saveData();
        }

        function updateScore(run) {
            scoreData.runs += run;
            scoreData.balls++;
            scoreData.bowlerRuns += run;
            scoreData.bowlerBalls++;

            if (scoreData.striker === 'Batter 1') {
                scoreData.batter1Score += run;
                scoreData.batter1Balls++;
            } else {
                scoreData.batter2Score += run;
                scoreData.batter2Balls++;
            }

            if (scoreData.balls % 6 === 0) {
                scoreData.overs++;
                scoreData.balls = 0;
            }

            if (run % 2 !== 0) {
                [scoreData.striker, scoreData.nonStriker] = [scoreData.nonStriker, scoreData.striker];
            }

            saveData();
        }

        function noBall() {
            scoreData.runs++;
            scoreData.bowlerRuns++;
            saveData();
        }

        function wideBall() {
            scoreData.runs++;
            scoreData.bowlerRuns++;
            saveData();
        }

        function wicket() {
            scoreData.wickets++;
            scoreData.bowlerWickets++;
            saveData();
        }

        function clearScorecard() {
            localStorage.removeItem('scoreData');
            location.reload();
        }

        function manualUpdate() {
            scoreData.runs = parseInt(document.getElementById("manualRuns").value) || scoreData.runs;
            scoreData.wickets = parseInt(document.getElementById("manualWickets").value) || scoreData.wickets;
            scoreData.overs = parseFloat(document.getElementById("manualOvers").value) || scoreData.overs;
            saveData();
        }

        function saveData() {
            localStorage.setItem('scoreData', JSON.stringify(scoreData));
            updateBackend();
            updateDisplay();
        }

        function updateBackend() {
            fetch('/api/score', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(scoreData)
            });
        }

        function updateDisplay() {
            document.getElementById('score').textContent = `Score: ${scoreData.runs}-${scoreData.wickets}`;
            document.getElementById('overs').textContent = `Overs: ${scoreData.overs}.${scoreData.balls}`;
            document.getElementById('striker').textContent = `Striker: ${scoreData.striker}`;
            document.getElementById('nonStriker').textContent = `Non-Striker: ${scoreData.nonStriker}`;
            document.getElementById('bowler').textContent = `Bowler: ${scoreData.bowler} ${scoreData.bowlerRuns}/${scoreData.bowlerWickets} (${scoreData.bowlerBalls})`;
        }

        updateDisplay();
    </script>
</body>
</html>
